# Audio Assistant

ä¸€ä¸ªåŸºäºŽ Go è¯­è¨€å¼€å‘çš„è¯­éŸ³åŠ©æ‰‹é¡¹ç›®ã€‚

## åŠŸèƒ½ç‰¹æ€§

- å®žæ—¶è¯­éŸ³é‡‡é›†
- è¯­éŸ³æ´»åŠ¨æ£€æµ‹ (VAD)
- è¯­éŸ³è¯†åˆ« (ASR)
- å¤§è¯­è¨€æ¨¡åž‹å¯¹è¯ (LLM)
- æ–‡æœ¬è½¬è¯­éŸ³ (TTS)
- å®žæ—¶è¯­éŸ³æ’­æ”¾
- æ‰“æ–­æœºåˆ¶

## çŽ¯å¢ƒè¦æ±‚

- Go 1.18 æˆ–æ›´é«˜ç‰ˆæœ¬
- PortAudio
- Python 3.8+ (ç”¨äºŽ VAD æœåŠ¡)
- OpenAI API Key

## å®‰è£…ä¾èµ–

1. å®‰è£… PortAudio:

```bash
# macOS
brew install portaudio

# Windows
# ä¸‹è½½å¹¶å®‰è£… PortAudio: https://www.portaudio.com/download.html
```

2. å®‰è£… Go ä¾èµ–:

```bash
go mod download
```

## å¿«é€Ÿå¼€å§‹

### è¿è¡Œå®Œæ•´è¯­éŸ³åŠ©æ‰‹

1. è®¾ç½®çŽ¯å¢ƒå˜é‡ï¼š
```bash
export OPENAI_API_KEY="your-openai-api-key"
```

2. ä¸€é”®å¯åŠ¨ï¼š
```bash
./scripts/start_voice_assistant.sh
```

### æ‰‹åŠ¨å¯åŠ¨

1. å¯åŠ¨ VAD æœåŠ¡ï¼š
```bash
cd scripts
python vad_service.py
```

2. å¯åŠ¨è¯­éŸ³åŠ©æ‰‹ï¼š
```bash
go run cmd/voice_assistant/main.go
```

### æµ‹è¯•å•ä¸ªç»„ä»¶

- LLM æµ‹è¯•ï¼š`go run cmd/llm_example/main.go`
- ASR æµ‹è¯•ï¼š`go run cmd/asr_example/main.go`  
- TTS æµ‹è¯•ï¼š`go run cmd/tts_example/main.go`

## é¡¹ç›®ç»“æž„

```
.
â”œâ”€â”€ cmd/            # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ internal/       # å†…éƒ¨åŒ…
â”‚   â”œâ”€â”€ audio/     # éŸ³é¢‘å¤„ç†
â”‚   â”œâ”€â”€ vad/       # è¯­éŸ³æ´»åŠ¨æ£€æµ‹
â”‚   â”œâ”€â”€ asr/       # è¯­éŸ³è¯†åˆ«
â”‚   â”œâ”€â”€ llm/       # å¤§è¯­è¨€æ¨¡åž‹
â”‚   â”œâ”€â”€ tts/       # æ–‡æœ¬è½¬è¯­éŸ³
â”‚   â”œâ”€â”€ interrupt/ # æ‰“æ–­æŽ§åˆ¶
â”‚   â””â”€â”€ state/     # çŠ¶æ€ç®¡ç†
â”œâ”€â”€ pkg/           # å…¬å…±åŒ…
â””â”€â”€ scripts/       # è„šæœ¬æ–‡ä»¶
```

## è¿è¡Œç¤ºä¾‹
```
~: export OPENAI_API_KEY="your-openai-api-key"
~: go run cmd/voice_assistant/main.go

2025/06/13 23:41:56 å¯åŠ¨è¯­éŸ³åŠ©æ‰‹...
2025/06/13 23:41:56 VAD æœåŠ¡è¿žæŽ¥æ­£å¸¸
2025/06/13 23:41:56 è¯­éŸ³åŠ©æ‰‹å·²å¯åŠ¨ï¼Œæ­£åœ¨ç›‘å¬...
=== è¯­éŸ³åŠ©æ‰‹å·²å°±ç»ªï¼Œæ‚¨å¯ä»¥å¼€å§‹å¯¹è¯ ===
2025/06/13 23:41:58 State changed: Idle -> Listening
ðŸŽ¤ å¼€å§‹å½•éŸ³...
ðŸ”‡ æ£€æµ‹åˆ°é™éŸ³ï¼Œç»“æŸå½•éŸ³
2025/06/13 23:42:01 State changed: Listening -> Processing
2025/06/13 23:42:01 State changed: Processing -> Idle
ðŸ”„ æ­£åœ¨å¤„ç†éŸ³é¢‘...
ðŸ‘¤ ç”¨æˆ·: è«‹ä½ çµ¦æˆ‘è¬›å€‹æ•…äº‹
ðŸ¤– åŠ©æ‰‹: å½“ç„¶ï¼è¿™æ˜¯ä¸€ä¸ªå…³äºŽå‹‡æ•¢çš„å°çŒ«å’ªçš„æ•…äº‹ã€‚å°çŒ«å’ªåå«å°èŠ±ï¼Œå®ƒä½åœ¨ä¸€ä¸ªç¾Žä¸½çš„å°æ‘åº„é‡Œã€‚æœ‰ä¸€å¤©ï¼Œå°èŠ±å¬è¯´æ£®æž—é‡Œæœ‰ä¸€åªè¢«å›°çš„å°é¸Ÿï¼ŒäºŽæ˜¯å®ƒå†³å®šåŽ»æ•‘æ´ã€‚å°èŠ±è·‹å±±æ¶‰æ°´ï¼Œç»ˆäºŽæ¥åˆ°äº†æ£®æž—ï¼Œæ‰¾åˆ°äº†å°é¸Ÿã€‚å°èŠ±ç”¨å®ƒçš„çˆªå­å’Œç‰™é½¿æ‰“å¼€äº†å›°ä½å°é¸Ÿçš„é™·é˜±ï¼Œå°é¸ŸèŽ·å¾—è‡ªç”±åŽï¼Œéžå¸¸æ„Ÿæ¿€åœ°å¯¹å°èŠ±è¯´ï¼šâ€œè°¢è°¢ä½ ï¼Œå°èŠ±ï¼Œä½ æ˜¯ä¸€åªå‹‡æ•¢åˆå–„è‰¯çš„å°çŒ«å’ªï¼â€ä»Žæ­¤ä»¥åŽï¼Œå°èŠ±å’Œå°é¸Ÿæˆä¸ºäº†æœ€å¥½çš„æœ‹å‹ï¼Œå®ƒä»¬ä¸€èµ·åœ¨æ£®æž—é‡ŒæŽ¢é™©ï¼Œåˆ†äº«å¿«ä¹ã€‚æ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œå‹‡æ•¢å’Œå–„è‰¯æ˜¯æœ€çè´µçš„å“è´¨ï¼Œä¹Ÿè®©æˆ‘ä»¬æ˜Žç™½äº†å‹è°Šçš„åŠ›é‡ã€‚å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼
2025/06/13 23:42:06 State changed: Idle -> Speaking
WAV file analysis for /var/folders/63/l52f96md6pd54wmg1mr257br0000gn/T/audio_decode_578213357.wav:
  RIFF chunk size: 4294967295
  File size: 2330444
  Found chunk: fmt , size: 16
  Found chunk: data, size: 4294967295
  Audio format: 1 (PCM=1)
  Channels: 1
  Sample rate: 24000
  Bits per sample: 16
  Data offset: 44
  Data size: 4294967295
  Warning: Data size in header (4294967295) exceeds file bounds. Using actual size: 2330400
  Calculated samples: 1165200
  Successfully loaded 1165200 samples
2025/06/13 23:42:13 å‡†å¤‡æ’­æ”¾éŸ³é¢‘: æ ·æœ¬æ•°=1165200, é‡‡æ ·çŽ‡=24000 Hz, æ—¶é•¿=48.55ç§’
2025/06/13 23:42:13 é‡é‡‡æ ·éŸ³é¢‘: 24000 Hz -> 16000 Hz
é‡é‡‡æ ·: 24000 Hz (1165200 æ ·æœ¬) -> 16000 Hz (776800 æ ·æœ¬)
ðŸš« æ£€æµ‹åˆ°ç”¨æˆ·æ‰“æ–­
```